# 销售员回款数据转换工具 - 网页版使用说明

## 📋 功能概述

这是一个纯前端的数据转换工具，无需安装 Python 或任何依赖，只需浏览器即可运行。

**核心功能：**
- ✅ 从多地区工作表中提取 2025 年回款数据
- ✅ 自动识别 2 行表头结构
- ✅ 按业务员汇总月度回款
- ✅ 匹配员工基础信息获取部门
- ✅ 生成标准格式的汇总表
- ✅ 支持本地文件处理，数据不上传到服务器

## 🚀 使用方法

### 方法一：直接打开（推荐）

1. 双击 `index.html` 文件
2. 在浏览器中自动打开（推荐使用 Chrome、Edge 或 Firefox）
3. 按照页面提示上传文件并转换

### 方法二：本地服务器运行

如果遇到文件访问限制，可以使用本地服务器：

```bash
# 使用 Python 3
cd "当前目录"
python -m http.server 8000

# 使用 Python 2
python -m SimpleHTTPServer 8000

# 使用 Node.js (需要安装 http-server)
npx http-server
```

然后在浏览器中访问：`http://localhost:8000`

## 📝 操作步骤

### 第 1 步：准备文件

确保你有以下两个文件：
- **原始回款数据文件**：包含各地区工作表（杭州、湖州、金衢等）
- **员工基础信息表**：包含员工姓名和所属地区

### 第 2 步：上传文件

1. 点击"选择文件"按钮上传**原始回款数据文件**
2. 点击"选择文件"按钮上传**员工基础信息表**
3. 等待两个文件都上传完成（文件名会变绿色显示）

### 第 3 步：开始转换

1. 当两个文件都上传后，"开始转换"按钮会变为可用状态
2. 点击"开始转换"按钮
3. 观察进度条和处理信息

### 第 4 步：查看结果并下载

1. 转换完成后会显示统计信息：
   - 业务员数量（只包含员工表中的员工）
   - 总回款金额（2025 年）
   - 数据覆盖月份
2. 如果有非员工记录被过滤，会显示：
   - 过滤的非员工数量
   - 被过滤的名单（如"专卖店"、"零售"等）
3. 查看前 10 名业务员回款情况预览
4. 点击"📥 下载结果文件"按钮保存 Excel 文件

**🔍 智能过滤功能：**
系统会自动过滤掉不在员工基础信息表中的记录，只保留你公司的在职员工数据。

## 🎯 支持的数据格式

### 原始回款数据文件格式

**工作表要求：**
- 必须包含以下工作表：杭州、湖州、金衢、嘉兴、台州、绍兴、温丽
- 每个工作表必须有 2 行表头：
  - 第 0 行：字段名（"1月"、"2月"...）
  - 第 1 行：年份标识（"2024年"、"2025年"）
  - 第 2 行开始：实际数据

**数据列要求：**
- 业务员名称必须在第 8 列（H列，索引 7）
- 月份数据列需包含年份标识（2025年）

### 员工基础信息表格式

**必需列：**
- `员工姓名`：业务员姓名
- `所属地区`：杭州、湖州、金华、嘉兴等

## 🔧 技术特点

### 优势

1. **无需安装**：不需要 Python 环境，直接用浏览器打开
2. **数据安全**：所有处理都在本地浏览器完成，数据不上传
3. **跨平台**：Windows、Mac、Linux 都可以使用
4. **即时反馈**：实时显示处理进度和结果预览
5. **界面友好**：现代化 UI 设计，操作简单直观

### 使用的技术

- **HTML5**：页面结构
- **CSS3**：现代化样式和动画
- **JavaScript (ES6+)**：核心逻辑
- **SheetJS (xlsx.js)**：Excel 文件读写（CDN 引入，无需安装）

## 📊 输出格式

生成的 Excel 文件包含以下列：

| 列名 | 说明 |
|-----|------|
| 销售员 | 业务员姓名 |
| 销售组织 | 杭州中冠电器有限公司 |
| 销售部门 | 根据地区自动匹配（杭州大区、湖州办事处等） |
| 1月~9月 | 各月回款金额（2025年数据） |
| 10月~12月 | 暂填 0（可后续补充） |
| 参考总额 | 1-9月合计金额 |
| 填写说明 | 提示信息 |

## ⚠️ 常见问题

### Q1: 点击"开始转换"按钮没反应？

**答：** 确保两个文件都已成功上传，文件名显示为绿色。

### Q2: 显示"转换失败"？

**可能原因：**
1. Excel 文件格式不正确
2. 工作表名称不匹配（注意"温丽 "末尾有空格）
3. 表头结构发生变化
4. 业务员列位置不在第 8 列

**解决方法：**
1. 检查 Excel 文件是否完整
2. 确认工作表名称正确
3. 打开浏览器控制台（F12）查看详细错误信息

### Q3: 下载的文件打不开？

**答：** 确保使用现代浏览器（Chrome 90+、Firefox 88+、Edge 90+）。如果还有问题，尝试：
1. 清除浏览器缓存
2. 使用隐私/无痕模式打开页面
3. 尝试其他浏览器

### Q4: 部分业务员数据为 0？

**可能原因：**
1. 该业务员只有 2024 年数据，没有 2025 年数据
2. 年份列识别错误

**解决方法：**
1. 打开控制台（F12）查看日志，确认是否正确识别到 2025 年数据列
2. 检查原始 Excel 文件中该业务员的数据

### Q5: 业务员部门显示"销管部"不正确？

**答：** 这是默认部门。原因可能是：
1. 该业务员不在员工基础信息表中（会被自动过滤）
2. 员工基础信息表中缺少"所属地区"字段

**解决方法：**
1. 在员工基础信息表中补充该业务员信息
2. 或者在输出的 Excel 中手动修改部门

### Q6: 为什么有些记录被过滤了？

**答：** 系统会自动过滤不在员工表中的记录，常见的被过滤记录包括：
- "专卖店"、"零售"、"杭州零售" 等非个人名称
- 已经离职的员工
- 特殊账户或临时账户

**这是正常的！** 过滤功能确保输出的数据只包含你公司的在职员工，使数据更准确。

转换完成后，你可以在结果页面看到：
- 被过滤了多少个记录
- 具体是哪些名称被过滤了

如果某个员工不应该被过滤，请检查员工基础信息表中是否包含该员工。

## 🌐 浏览器兼容性

| 浏览器 | 最低版本 | 推荐版本 |
|--------|---------|---------|
| Chrome | 90+ | 最新版 ✅ |
| Firefox | 88+ | 最新版 ✅ |
| Edge | 90+ | 最新版 ✅ |
| Safari | 14+ | 最新版 ✅ |
| IE | ❌ 不支持 | - |

## 📱 移动端支持

本工具也支持在移动设备上使用：
- iOS Safari 14+
- Android Chrome 90+

但建议在电脑上使用以获得最佳体验。

## 🔄 与 Python 版本对比

| 特性 | Python 版本 | 网页版本 |
|-----|------------|---------|
| 功能完整性 | ✅ 完整 | ✅ 完整 |
| 智能过滤 | 需手动删除非员工 | 自动过滤 ✅ |
| 安装要求 | 需要 Python + pandas + openpyxl | 无需安装 ✅ |
| 使用难度 | 需要命令行操作 | 图形界面，更简单 ✅ |
| 数据安全性 | 本地处理 ✅ | 本地处理 ✅ |
| 处理速度 | 快 | 快 |
| 进度反馈 | 文字输出 | 可视化进度条 ✅ |
| 结果预览 | 无 | 有表格预览 ✅ |
| 过滤统计 | 无 | 显示过滤信息 ✅ |
| 跨平台 | ✅ | ✅ |

## 📄 文件清单

- ✅ `index.html` - 网页主文件
- ✅ `styles.css` - 样式文件
- ✅ `script.js` - 核心逻辑文件
- ✅ `网页工具使用说明.md` - 本文档
- ✅ `使用说明.md` - Python 版本使用说明
- ✅ `转换为模板格式_最终版.py` - Python 版本脚本

## 🎨 界面预览

网页工具具有现代化的界面设计：
- 🎨 渐变色背景
- 📊 数据可视化展示
- ⚡ 流畅的动画效果
- 📱 响应式设计（支持手机/平板）
- 🌈 直观的进度反馈

## 💡 使用技巧

1. **批量处理**：可以先打开网页，然后依次处理多个文件
2. **数据验证**：转换完成后，查看预览表格快速验证数据是否正确
3. **保存网页**：可以将整个文件夹保存到 U 盘，随时随地使用
4. **收藏书签**：将 index.html 添加到浏览器书签，方便下次使用

## 🆘 获取帮助

如果遇到问题：
1. 查看本文档的"常见问题"部分
2. 打开浏览器控制台（按 F12）查看错误信息
3. 对比原始 Python 脚本的处理逻辑
4. 检查输入文件格式是否符合要求

## 📝 更新日志

### v1.1 (2025-10-22)
- ✅ 新增智能过滤功能：自动过滤非员工记录
- ✅ 显示过滤统计信息（过滤数量和名单）
- ✅ 优化数据准确性，只输出在职员工数据

### v1.0 (2025-10-22)
- ✅ 初始版本发布
- ✅ 支持 2 行表头识别
- ✅ 支持 2025 年数据提取
- ✅ 支持多地区工作表处理
- ✅ 支持员工信息匹配
- ✅ 现代化 UI 设计
- ✅ 实时进度反馈
- ✅ 结果预览功能

---

**版本：** Web v1.1  
**最后更新：** 2025-10-22  
**数据年份：** 2025年  
**兼容性：** 与 Python 版本完全一致（增强版）

