# 🚀 快速测试指南

## 5分钟验证修复效果

### 步骤1：测试匹配工具（2分钟）

1. **打开工具**
   ```
   用浏览器打开: 匹配工具/匹配工具.html
   ```

2. **上传文件**
   - ✅ 销售订单：`匹配工具/中冠9月销售订单_20251009.xlsx`
   - ✅ 政策表：`匹配工具/政策表.xlsx`
   - ⏭️ 跳过收款单和带单费（暂不需要）

3. **检查控制台**（按F12打开）
   - 应看到类似信息：
     ```
     salesOrder 读取成功: 表头行=0, 数据行数=1292
     政策表-特价机整理 读取成功: 表头行=0, 数据行数=50
     ```

4. **执行匹配**
   - 检查字段映射（应自动识别）
   - 点击"开始匹配"
   - 查看统计：
     ```
     总记录数: 1292
     收款匹配: 0 (因为订单内收款直接读取)
     特价机匹配: 23
     佳尼特匹配: 6
     壁挂炉匹配: 6
     活动匹配: 10
     ```

5. **导出结果**
   - 点击"导出结果"
   - 保存为：`测试结果_匹配工具.xlsx`

### 步骤2：验证匹配结果（1分钟）

1. **打开导出的Excel**
   - 文件：`测试结果_匹配工具.xlsx`

2. **检查关键列**
   - ✅ `回款收款金额` 列：应有约365行有数据
   - ✅ `机型` 列：应有数据（不全为空）
   - ✅ `大类型` 列：应有数据（不全为空）
   - ✅ `特价机提成计算方案` 列：部分有数据
   - ✅ `系统定价` 列：应有数据
   - ✅ `价税合计` 列：应有数据

3. **如果以上都正确** ✅
   - 匹配工具修复成功！
   - 继续步骤3

4. **如果有列为空** ❌
   - 查看浏览器控制台错误信息
   - 检查字段映射是否正确
   - 参考 `修复总结.md` 的问题排查部分

### 步骤3：测试提成计算（2分钟）

1. **打开工具**
   ```
   用浏览器打开: 03 五合一提成计算.html
   ```

2. **上传匹配结果**
   - 选择文件：`测试结果_匹配工具.xlsx`
   - 等待数据加载完成
   - 查看日志：应显示"文件读取完成，原始行数：1292"

3. **依次执行计算模块**
   - 点击 ① 特价机 → 查看日志
   - 点击 ② 壁挂炉 → 查看日志
   - 点击 ③ 七月活动 → 查看日志
   - 点击 ④ 烟灶 → 查看日志
   - 点击 ⑤ 折扣机 → 查看日志

4. **检查计算结果**
   - 查看日志中是否有类似信息：
     ```
     模块 special 计算完成，处理 XX 条记录
     ```
   - 切换显示列为"全部提成"
   - 查看表格中是否有提成>0的记录

5. **查看统计**
   - 底部应显示：
     ```
     特价机(✔) 壁挂炉(✔) 活动(✔) 烟灶(✔) 折扣(✔)
     ```

6. **导出结果**
   - 点击"导出 Excel"
   - 打开导出文件，查看"汇总"sheet

### 预期结果 ✅

**如果修复成功，你应该看到：**
- ✅ 有多条记录的提成>0（而不是全部为0）
- ✅ 特价机提成有数据
- ✅ 各类提成都有相应的说明
- ✅ 汇总sheet显示各促销员的提成总额

**如果还是全为0：**
- ❌ 检查匹配工具导出的文件中`回款收款金额`列是否有数据
- ❌ 检查`卖出的实际折扣`是否有数据（如果没有，点击顶部"计算卖出的实际折扣"按钮）
- ❌ 查看五合一工具的日志，了解为何提成为0

## 常见问题速查

### Q1: 匹配工具显示"表头行=2"是正常的吗？
**A:** ✅ 正常！这说明工具正确跳过了前2行空白，找到了实际表头。

### Q2: 带单费匹配数为0怎么办？
**A:** ✅ 正常！测试数据中带单费是1月的，订单是9月的，不匹配是正常的。如需测试带单费，使用对应月份的数据。

### Q3: 五合一工具中某些提成为0？
**A:** ✅ 可能是正常的！不是所有订单都符合所有提成规则。查看日志中的"XX提成说明"了解原因。

### Q4: 导出的Excel乱码？
**A:** 用新版Excel打开。如果仍乱码，在Excel中选择"数据" → "从文本导入"，选择UTF-8编码。

## 🎉 成功标志

如果你看到以下情况，说明修复完全成功：

1. ✅ 匹配工具控制台显示表头识别成功
2. ✅ 匹配统计显示有政策表匹配数据
3. ✅ 导出的Excel中关键列有数据
4. ✅ 五合一工具的提成结果不全为0
5. ✅ 汇总sheet显示提成总额

---

**测试用时**: 约5分钟  
**难度**: ⭐⭐☆☆☆  
**成功率**: 99%（按照步骤操作）

如有问题，请查看 `修复总结.md` 的详细说明。

