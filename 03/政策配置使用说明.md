# 活动套餐政策配置使用说明

## 功能概述

现在支持通过上传Excel文件来自定义修改套餐政策，无需修改HTML代码即可更新：
- 旧套餐规则
- 组合套餐政策
- 活动机型政策

## 使用步骤

### 1. 下载政策配置模板

打开 `活动套餐前置.html`，在页面顶部"政策配置文件"区域，点击**"点击下载Excel模板"**链接，会自动下载 `活动套餐政策配置模板.xlsx` 文件。

### 2. 编辑模板文件

下载后的Excel文件包含3个工作表（Sheet），按需修改：

#### Sheet 1: 旧套餐规则

| 列名 | 说明 | 示例 |
|------|------|------|
| 套餐编号 | 套餐的唯一编号 | 1, 2, 3... |
| 产品1~4 | 套餐包含的产品型号（最多4个） | CXW-350-Q2CWI |
| 价格1~4 | 对应产品的价格 | 5678 |
| 套餐价 | 套餐总价 | 5098 |
| 提成金额 | 该套餐的提成金额 | 300 |

**注意：**
- 如果套餐少于4个产品，多余的列留空即可
- 产品型号需准确填写，系统会自动标准化处理

#### Sheet 2: 组合套餐政策

| 列名 | 说明 | 示例 |
|------|------|------|
| 套餐名称 | 套餐政策的名称 | 九件套、五件套 |
| 优先级 | 数字越小优先级越高 | 1, 2, 3... |
| 单套激励 | 每套的激励金额 | 1000 |
| 必需品类1~7 | 必需的品类或分组（最多7个） | 烟机、热水器、GROUP_A |
| 特殊说明 | 用于配置分组或特殊型号 | groupA:[烟机,蒸烤,洗碗机] |

**特殊说明格式：**
- 分组定义：`groupA:[烟机,蒸烤,洗碗机] groupB:[净水,热水器]`
- 指定型号：`specificModels:[ER1600BWi,KZQ45-M1Wi]`
- 可组合使用，空格分隔

**品类别名：**
系统会自动识别以下品类别名：
- 烟机：烟机、油烟机
- 蒸烤：蒸箱、蒸烤、蒸烤箱、蒸烤一体机
- 洗碗机：洗碗机、洗碗
- 热水器：热水器、燃热、燃气热水器
- 净水：净水、净水机、净水器、饮水
- 冰箱：冰箱、松下冰箱
- 洗护：洗护、洗衣机、洗烘套装、洗烘、松下洗护

#### Sheet 3: 活动机型政策

| 列名 | 说明 | 示例 |
|------|------|------|
| 机型型号 | 参与活动的机型型号 | JSQ31-VJSAI |
| 类型 | 产品类型 | 燃热、净水、其他 |
| 激励模式 | flat=直接加提，threshold=阶梯制 | flat 或 threshold |
| 单台激励 | 每台的激励金额 | 100 |
| 阈值 | 仅threshold模式需要填写 | 3, 5（达到此数量才计提） |
| 说明备注 | 备注信息 | 加提100元/台+赠品 |

**激励模式说明：**
- `flat`：直接加提，每台固定金额，无门槛
- `threshold`：阶梯制，达到阈值后全量计提（非增量）

### 3. 上传配置文件

在 `活动套餐前置.html` 页面的"政策配置文件"区域，点击上传框或拖拽修改后的Excel文件到上传区域。

成功上传后会显示：**"政策配置加载成功！已更新所有规则。"**

### 4. 继续正常使用

上传配置文件后，系统会使用您自定义的政策进行计算：
1. 上传数据文件
2. 完成字段映射
3. 计算旧套餐/套餐政策/活动机型
4. 导出结果

## 注意事项

1. **可选功能**：如果不上传政策配置文件，系统会使用内置的默认配置
2. **完整替换**：上传配置文件会替换所有政策规则，请确保配置完整
3. **自动保存** ✨：
   - 上传的配置会**自动保存**在浏览器的本地存储中
   - 下次打开页面会**自动加载**上次的配置
   - 无需重复上传，一次配置长期有效
   - 如需恢复默认配置，点击配置状态栏中的"恢复默认"链接
4. **格式要求**：
   - Sheet名称必须准确：`旧套餐规则`、`组合套餐政策`、`活动机型政策`
   - 列名必须与模板一致
   - 数值型字段（价格、金额、优先级等）请填写数字
5. **建议流程**：
   - 先下载模板
   - 在模板基础上修改
   - 测试验证后再正式使用

## 配置示例

### 示例1：添加新的旧套餐

在"旧套餐规则"sheet中新增一行：

| 套餐编号 | 产品1 | 价格1 | 产品2 | 价格2 | 产品3 | 价格3 | 产品4 | 价格4 | 套餐价 | 提成金额 |
|---------|-------|-------|-------|-------|-------|-------|-------|-------|--------|----------|
| 8 | 新型号A | 6000 | 新型号B | 4000 | | | | | 9000 | 500 |

### 示例2：修改活动机型激励

在"活动机型政策"sheet中修改：

将 `JSQ31-VJSAI` 的单台激励从 100 改为 150：

| 机型型号 | 类型 | 激励模式 | 单台激励 | 阈值 | 说明备注 |
|---------|------|---------|---------|------|----------|
| JSQ31-VJSAI | 燃热 | flat | 150 | | 活动期加提150元/台 |

### 示例3：添加新的组合套餐

在"组合套餐政策"sheet中新增：

| 套餐名称 | 优先级 | 单套激励 | 必需品类1 | 必需品类2 | 必需品类3 | 必需品类4 | 必需品类5 | 必需品类6 | 必需品类7 | 特殊说明 |
|---------|--------|---------|----------|----------|----------|----------|----------|----------|----------|----------|
| 三件套 | 6 | 150 | 热水器 | 净水 | 烟机 | | | | | |

## 常见问题

**Q: 上传配置后是否需要重新上传数据文件？**  
A: 不需要。如果已经上传了数据文件，直接重新点击计算按钮即可使用新配置。

**Q: 配置文件上传后会保存吗？** ✨  
A: **会自动保存！** 上传的配置会保存在浏览器的本地存储中，下次打开页面会自动加载。无需每次重复上传。

**Q: 如何恢复到默认配置？**  
A: 在"政策配置"区域的配置状态栏中，点击"恢复默认"链接即可清除自定义配置并恢复默认值。

**Q: 刷新页面配置还在吗？**  
A: 在！配置保存在浏览器本地存储中，刷新页面、关闭浏览器后重新打开都会自动加载。

**Q: 能否只修改部分政策？**  
A: 建议下载完整模板并保留不需要修改的部分，上传时会全量替换所有规则。

**Q: 型号大小写是否敏感？**  
A: 系统会自动进行标准化处理（转大写、去除空格），但建议与实际数据保持一致。

**Q: 更换电脑或浏览器后配置还在吗？**  
A: 不在。配置保存在当前浏览器的本地存储中，更换浏览器或电脑需要重新上传配置文件。

## 技术支持

如有问题或需要帮助，请联系系统管理员。

---

更新日期：2025-11-05

