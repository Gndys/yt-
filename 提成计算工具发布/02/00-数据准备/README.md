# 💰 业务员奖金计算系统 v1.0

一个功能完整的业务员奖金计算系统，支持月度/季度奖金计算、211厨电考核管理、Excel数据导入导出等功能。

## ✨ 特性

- 🎯 **月度奖金计算** - 自动计算基础奖金、回款负激励、211负激励
- 📈 **季度奖金计算** - 支持季度红线规则和负激励返还
- ✏️ **211数据管理** - 在线编辑211厨电考核数据
- 📊 **数据统计** - 实时显示统计信息和数据状态
- 📥 **Excel导入导出** - 完整的Excel文件处理能力
- 🔍 **数据搜索** - 快速筛选和查找数据
- 💻 **纯前端实现** - 无需后端，数据本地处理更安全
- 🌐 **离线可用** - 下载后可完全离线使用

## 📁 文件说明

```
00-数据准备/
├── salary-calculator.html      # 主程序（双击打开使用）
├── 使用说明.md                 # 详细使用说明
├── 开发文档.md                 # 完整的开发文档
├── 生成测试数据.py             # 测试数据生成脚本
├── 测试_员工基础信息表.xlsx    # 测试数据文件
├── 测试_任务分配表.xlsx        # 测试数据文件
├── 测试_销售员回款汇总表.xlsx  # 测试数据文件
└── 测试_211厨电表.xlsx         # 测试数据文件
```

## 🚀 快速开始

### 方法1：使用测试数据快速体验

1. **打开系统**
   ```bash
   双击 salary-calculator.html
   ```

2. **上传测试数据**
   - 员工基础信息表：`测试_员工基础信息表.xlsx`
   - 任务分配表：`测试_任务分配表.xlsx`
   - 销售员回款汇总表：`测试_销售员回款汇总表.xlsx`
   - 211厨电表：`测试_211厨电表.xlsx`

3. **开始计算**
   - 选择"8月"进行月度计算
   - 切换到季度计算，选择"Q3"进行季度计算

### 方法2：使用真实数据

1. 准备您的Excel数据文件（参考"使用说明.md"中的格式要求）
2. 打开 `salary-calculator.html`
3. 上传数据文件
4. 选择月份/季度并计算
5. 导出结果

## 📊 计算规则

### 月度奖金

```
完成率 = 回款 ÷ 任务
基础奖金 = 标准奖金 × 70% × 完成率
实发奖金 = 基础奖金 - 回款负激励 - 211负激励
```

**回款负激励（仅杭州）**：
- 完成率 < 50%：扣标准奖金 × 20%
- 50% ≤ 完成率 < 80%：扣标准奖金 × 10%
- 完成率 ≥ 80%：不扣

**211负激励**：
```
扣款 = 800 - (完成分值 ÷ 任务分值) × 800
```

### 季度奖金

```
季度完成率 = 季度回款 ÷ 季度任务
基础奖金 = 标准奖金 × 30% × 3 × 季度完成率
实发奖金 = 基础奖金 + 返还金额
```

**杭州红线**：季度完成率 < 50% → 奖金归零

**返还规则**：季度完成率 ≥ 80% → 返还该季度所有月度回款负激励

## 🎨 系统界面

系统包含三个主要页面：

### 1. 月度计算
- 上传4个基础数据文件
- 选择计算月份
- 查看月度奖金明细、回款明细、211考核
- 导出计算结果

### 2. 季度计算
- 利用月度数据进行季度汇总
- 计算季度奖金和返还金额
- 支持红线规则判断

### 3. 211管理
- 上传211数据
- 在线编辑（添加/修改/删除）
- 下载模板
- 保存数据

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + S` | 保存211数据 |
| `Ctrl + E` | 导出Excel |

## 📋 数据格式要求

### 员工基础信息表
| 员工姓名 | 标准奖金 | 所属地区 | 业务类型 | 备注 |
|---------|---------|---------|---------|------|

### 任务分配表
| 负责人 | 区域 | 1月 | 2月 | ... | Q1 | Q2 | Q3 | Q4 |
|-------|------|-----|-----|-----|----|----|----|----|

**注意**：任务单位为万元

### 销售员回款汇总表
| 销售员 | 1月 | 2月 | 3月 | ... |
|-------|-----|-----|-----|-----|

**注意**：回款单位为元

### 211厨电表
| 月份 | 具体地区 | 业务人员 | 任务 | 完成 | 备注 |
|------|---------|---------|------|------|------|

## 🔧 技术栈

- **前端框架**：纯HTML + CSS + JavaScript
- **Excel处理**：SheetJS (xlsx.js) v0.18.5
- **浏览器要求**：Chrome 80+ / Edge 80+ / Firefox 75+ / Safari 13+

## 📖 文档

- [使用说明.md](使用说明.md) - 详细的使用指南
- [开发文档.md](开发文档.md) - 完整的开发文档和技术实现

## 🧪 测试数据

项目包含完整的测试数据，覆盖以下场景：

- ✅ 正常员工（张三、李四、王五、钱七）
- ✅ 试用期员工（赵六）
- ✅ 杭州地区回款负激励（张三、李四、赵六）
- ✅ 非杭州地区无负激励（王五、钱七）
- ✅ 不同完成率情况（50%以下、50-80%、80%以上）
- ✅ 211考核多种分值（满分、部分完成、低分）
- ✅ 季度红线触发和返还场景

### 重新生成测试数据

```bash
python 生成测试数据.py
```

这将生成：
- 1个合并Excel文件（包含所有工作表）
- 4个独立Excel文件（用于系统上传）

## 💡 使用技巧

1. **数据准备**
   - 建议先用测试数据熟悉系统
   - 确保Excel列名完全匹配
   - 员工姓名在所有表格中必须一致

2. **计算验证**
   - 先计算一个月验证结果
   - 检查试用期员工是否正确识别
   - 确认杭州地区负激励是否生效

3. **211管理**
   - 可以先上传初始数据
   - 在线编辑调整
   - 保存后重新计算

4. **离线使用**
   - 整个HTML文件可以下载到本地
   - 无需网络即可使用
   - 数据完全本地处理，安全可靠

## ⚠️ 注意事项

1. **数据单位**
   - 任务：万元（自动转换）
   - 回款：元
   - 奖金：元

2. **员工姓名**
   - 所有表格中的姓名必须完全一致
   - 注意空格和特殊字符

3. **试用期标注**
   - 在备注列包含"试用期"或"试用"即可

4. **浏览器版本**
   - 不支持IE浏览器
   - 推荐使用Chrome最新版

## 🐛 常见问题

### Q: 文件上传后显示验证失败？
A: 检查列名是否正确，确认数据类型（数字列不能是文本）

### Q: 计算结果显示数据缺失？
A: 确认员工姓名在所有表格中完全一致

### Q: 如何批量修改数据？
A: 可以重新编辑Excel后上传，或在211管理页面在线编辑

### Q: 导出的Excel无法打开？
A: 使用Excel 2013+或WPS打开

## 📊 预期测试结果（8月）

使用测试数据计算8月奖金，预期结果：

| 员工 | 完成率 | 基础奖金 | 回款负激励 | 211负激励 | 实发奖金 |
|------|--------|---------|-----------|----------|---------|
| 张三 | 80% | 3920 | 0 | 160 | 3760 |
| 李四 | 70% | 2940 | 600 | 240 | 2100 |
| 王五 | 90% | 4095 | 0 | 80 | 4015 |
| 赵六 | 70% | 0 | 0 | 0 | 0 |
| 钱七 | 90% | 4725 | 0 | 0 | 4725 |

## 📈 系统优势

- ✅ **零部署成本** - 无需服务器，纯前端运行
- ✅ **数据安全** - 本地处理，不上传任何数据
- ✅ **操作简单** - 可视化界面，无需编程知识
- ✅ **功能完整** - 覆盖月度、季度、211管理全流程
- ✅ **易于维护** - 单文件架构，便于更新和分发
- ✅ **响应式设计** - 支持PC和平板设备

## 📝 版本历史

### v1.0.0 (2025-10-08)
- ✨ 初始版本发布
- ✅ 实现月度奖金计算
- ✅ 实现季度奖金计算
- ✅ 实现211数据管理
- ✅ 支持Excel导入导出
- ✅ 支持试用期员工识别

## 🔮 未来计划

- [ ] 添加数据可视化图表
- [ ] 支持历史数据对比
- [ ] 添加自定义计算规则
- [ ] 支持多用户权限管理
- [ ] 移动端适配优化
- [ ] 支持更多数据格式

## 📞 支持

如有问题，请检查：
1. 浏览器版本是否符合要求
2. Excel文件格式是否正确
3. 数据列名是否匹配

## 📄 许可证

本项目仅供学习和内部使用。

---

**开发者**: AI Assistant  
**版本**: v1.0.0  
**日期**: 2025-10-08  

🎉 **开始使用，祝您使用愉快！**

