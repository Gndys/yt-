# 业务员奖金计算系统 - 使用说明

## 📌 快速开始

### 1. 打开系统
双击 `salary-calculator.html` 文件，在浏览器中打开即可使用。

**推荐浏览器**：
- Chrome 80+
- Edge 80+
- Firefox 75+
- Safari 13+

⚠️ **注意**：不支持 IE 浏览器

---

## 🎯 功能概览

本系统提供三大功能模块：

1. **月度奖金计算** - 计算每个业务员的月度奖金
2. **季度奖金计算** - 计算季度奖金和返还金额
3. **211数据管理** - 在线编辑211厨电考核数据

---

## 📊 月度奖金计算

### 步骤1: 准备数据文件

需要准备以下4个Excel文件：

#### 1️⃣ 员工基础信息表
| 员工姓名 | 标准奖金 | 所属地区 | 业务类型 | 备注 |
|---------|---------|---------|---------|------|
| 张三 | 7000 | 杭州 | 五星 | |
| 李四 | 6000 | 宁波 | 四星 | 试用期 |

**说明**：
- `标准奖金`：该员工的标准月度奖金
- `所属地区`：杭州地区会有回款负激励规则
- `备注`：如果包含"试用期"字样，该员工不参与考核

#### 2️⃣ 任务分配表
| 负责人 | 区域 | 1月 | 2月 | 3月 | ... | Q1 | Q2 | Q3 | Q4 |
|-------|------|-----|-----|-----|-----|----|----|----|----|
| 张三 | 汇德隆 | 40 | 35 | 45 | ... | 120 | 130 | 140 | 150 |

**说明**：
- 月度任务单位为 **万元**（系统会自动转换）
- 必须包含月度任务列（如 `1月`, `2月` 等）
- 季度任务（Q1-Q4）为可选，用于季度计算

#### 3️⃣ 销售员回款汇总表
| 销售员 | 销售组织 | 销售部门 | 总收款 | 总退款 | 回款 |
|-------|---------|---------|-------|-------|------|
| 张三 | 杭州中冠 | 杭州大区 | 433809 | 8090 | 425719 |

**或者包含月度明细**：
| 销售员 | 1月 | 2月 | 3月 | ... |
|-------|-----|-----|-----|-----|
| 张三 | 320000 | 280000 | 360000 | ... |

**说明**：
- 回款单位为 **元**
- 推荐使用月度明细格式

#### 4️⃣ 211厨电表
| 月份 | 具体地区 | 业务人员 | 任务 | 完成 | 备注 |
|------|---------|---------|------|------|------|
| 1 | 汇德隆 | 张三 | 10 | 8 | |
| 2 | 永乐 | 李四 | 10 | 7 | |

**说明**：
- `任务`：目标分值（通常为10分）
- `完成`：实际完成分值

### 步骤2: 上传数据

1. 点击对应的上传框
2. 选择准备好的Excel文件
3. 等待文件解析完成（显示"✓ 已上传"）

### 步骤3: 选择月份并计算

1. 选择要计算的月份（1-12月）
2. 点击 **"🚀 开始计算"** 按钮
3. 查看计算结果

### 步骤4: 查看和导出结果

**结果包含三个报表**：
- **月度奖金明细**：完整的奖金计算结果
- **回款明细**：各业务员的回款情况
- **211考核**：211厨电考核详情

**导出Excel**：
- 点击 **"📥 导出Excel"** 按钮
- 文件包含所有报表，以多个工作表形式呈现

---

## 📈 计算规则说明

### 月度奖金计算公式

```
完成率 = 回款 ÷ 任务
基础奖金 = 标准奖金 × 70% × 完成率
```

### 回款负激励（仅杭州地区）

| 完成率范围 | 扣款 |
|-----------|------|
| < 50% | 扣标准奖金 × 20% |
| 50% ~ 80% | 扣标准奖金 × 10% |
| ≥ 80% | 不扣款 |

### 211负激励

```
211扣款 = 800 - (完成分值 ÷ 任务分值) × 800
```

**示例**：
- 任务10分，完成8分：扣款 = 800 - (8÷10)×800 = 160元
- 任务10分，完成10分：扣款 = 0元
- 没有211记录：扣款 = 800元

### 实发奖金

```
实发奖金 = 基础奖金 - 回款负激励 - 211负激励
```

### 试用期员工

试用期员工的所有奖金和扣款均为0，不参与考核。

---

## 🏆 季度奖金计算

### 前提条件

必须先在月度计算页面上传：
- 员工基础信息表
- 任务分配表
- 销售员回款汇总表

### 计算步骤

1. 切换到 **"季度计算"** 页面
2. 选择要计算的季度（Q1-Q4）
3. 点击 **"🚀 开始计算"**
4. 查看和导出结果

### 季度奖金公式

```
季度完成率 = 季度回款 ÷ 季度任务
基础奖金 = 标准奖金 × 30% × 3 × 季度完成率
```

### 杭州红线规则

如果是杭州地区员工，且季度完成率 < 50%：
- **季度奖金归零**

### 返还规则（仅杭州地区）

如果季度完成率 ≥ 80%：
- **返还该季度所有月度回款负激励**

**示例**：
- 某员工第一季度三个月分别被扣700、700、0元
- 如果季度完成率≥80%，返还1400元
- 实发奖金 = 基础奖金 + 1400

---

## ✏️ 211数据管理

### 上传211数据

1. 切换到 **"211管理"** 页面
2. 点击 **"📤 上传211数据"**
3. 选择Excel文件

### 在线编辑

系统支持直接在网页上编辑211数据：

1. **添加记录**：点击 **"➕ 添加记录"**
2. **编辑数据**：直接修改表格中的内容
3. **删除记录**：点击行末的 🗑️ 按钮
4. **保存数据**：点击 **"💾 保存数据"**

### 下载模板

点击 **"📄 下载模板"** 可下载211数据的Excel模板。

---

## 🔍 数据搜索和筛选

在结果表格上方的搜索框中输入关键词，可以快速筛选数据：

- 搜索业务员姓名
- 搜索地区
- 搜索任何表格中的内容

点击 **"清除"** 恢复显示所有数据。

---

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + S` | 保存211数据（在211管理页面） |
| `Ctrl + E` | 导出Excel |

---

## 📊 统计面板说明

月度计算完成后，会显示统计面板：

- **总人数**：参与计算的业务员总数
- **数据完整**：数据齐全可以正常计算的人数
- **数据缺失**：缺少任务或回款数据的人数
- **试用期**：试用期员工人数
- **总奖金**：所有实发奖金之和
- **平均奖金**：数据完整员工的平均奖金

---

## ⚠️ 注意事项

### 数据格式要求

1. **Excel版本**：支持 .xlsx 和 .xls 格式
2. **列名必须完全匹配**：如 "员工姓名"、"标准奖金" 等
3. **月份格式**：可以是 "1月" 或 "1"，系统会自动识别
4. **数值类型**：
   - 标准奖金、任务、完成分值必须是数字
   - 姓名、地区必须是文本

### 员工姓名匹配

- 所有表格中的员工姓名必须 **完全一致**
- 注意空格和特殊字符
- 建议从一个主表复制姓名到其他表格

### 试用期员工标注

在员工基础信息表的"备注"列中，包含以下任一关键词即可识别为试用期：
- "试用期"
- "试用"

### 数据单位

- **任务**：万元（系统会自动转换为元）
- **回款**：元
- **奖金**：元

---

## 🛠️ 常见问题

### Q1: 文件上传后显示"数据验证失败"？

**解决方法**：
1. 检查Excel文件中的列名是否正确
2. 确认必需列是否存在
3. 检查数据类型是否正确（数字列不能是文本）

### Q2: 计算结果显示"数据缺失"？

**原因**：
- 该业务员在某个表格中没有对应数据
- 员工姓名在不同表格中不一致

**解决方法**：
1. 检查该员工在4个表格中的姓名是否完全一致
2. 确认所有表格都包含该员工的数据

### Q3: 导出的Excel无法打开？

**解决方法**：
1. 使用 Excel 2013 或更新版本
2. 尝试用 WPS 或 Google Sheets 打开

### Q4: 如何批量修改数据？

**方法1**：重新编辑Excel文件后上传
**方法2**：在211管理页面在线编辑（仅限211数据）

### Q5: 系统支持多少员工？

理论上没有限制，测试过100人的数据，计算速度良好。

---

## 💡 使用技巧

### 1. 数据备份

建议在计算前保存好原始Excel文件，以便后续修改。

### 2. 分步验证

1. 先上传员工信息和任务表
2. 查看是否所有员工都识别成功
3. 再上传回款和211数据

### 3. 211数据管理

如果211数据经常变动，可以：
1. 在211管理页面上传初始数据
2. 在线编辑调整
3. 点击导出保存最新版本

### 4. 离线使用

本系统是纯前端应用，可以：
1. 下载整个HTML文件
2. 保存到本地或U盘
3. 双击打开即可使用，无需网络

---

## 📞 技术支持

如有问题，请检查：
1. 浏览器版本是否符合要求
2. Excel文件格式是否正确
3. 数据列名是否匹配

---

## 📝 版本信息

**当前版本**：v1.0.0  
**发布日期**：2025-10-08  
**开发框架**：纯HTML + CSS + JavaScript  
**依赖库**：SheetJS (xlsx.js) v0.18.5

---

## 🎉 开始使用

1. 双击打开 `salary-calculator.html`
2. 准备好4个Excel文件
3. 按照步骤上传和计算
4. 导出结果报表

祝您使用愉快！ 💰

